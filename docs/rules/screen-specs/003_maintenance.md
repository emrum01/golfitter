# 画面仕様書の管理・品質

画面仕様書の品質チェック・管理・メンテナンスに関する完全ガイドです。このファイルだけを参照すれば、品質管理作業を完了できます。

## 品質チェック

### 必須チェック項目

画面仕様書を作成・更新する際は、以下の項目を必ずチェックしてください：

- [ ] 全ての必須セクションが存在するか
- [ ] 画面の目的が明確に記述されているか
- [ ] 開発環境URLのドメイン部分が定義されたものに厳密に沿っているか
- [ ] 入力項目の制約が明確か
- [ ] **権限名が用語集に定義された正式名称で統一されているか**
- [ ] 権限やシナリオによる出し分けが正確か
- [ ] エラーケースが網羅されているか
- [ ] 参照リンクが正しく機能するか
- [ ] 用語の使用が一貫しているか
- [ ] 表形式の記述が統一されているか
- [ ] **表に出力する内容が存在しない場合でも表が作成され、`----` でブランク表示が行われているか**
- [ ] ソースコード上で確認できる仕様のみ記述されているか

### レビュー基準

レビューを行う際は、以下の観点から評価してください：

#### 記述の一貫性

- 同じ概念に対して同じ用語が使われているか
- 表記方法（記号、改行など）が統一されているか
- 文体（ですます調/である調）が統一されているか

#### 用語の統一

- システム固有の用語が正しく使用されているか
- 略語の使用が適切か
- 用語集に定義されていない用語が使われていないか
- **権限名が用語集の正式名称で統一されているか**

#### 表形式での記述統一

- 表のフォーマットが [TEMPLATE.md](mdc:docs/screen-specs/TEMPLATE.md) に準拠しているか
- 列の幅や配置が適切か
- 必須項目が全て記載されているか
- **内容が存在しない場合でも表自体は出力されており、`----` でブランク表示となっているか**

#### リンク参照の正確性

- 参照リンクが正しいパスを指しているか
- 外部リンクが有効か
- 相対パスが正しく記述されているか

#### セクションの分け方

- 論理的な構造になっているか
- 適切な粒度で分割されているか
- 見出しレベルが適切か

### 品質改善プロセス

#### 定期レビュー

- 四半期ごとに既存の仕様書をレビュー
- 新しい仕様書は作成後1週間以内にレビュー
- レビュー結果は記録し、改善点を追跡

#### フィードバックの収集

- 仕様書の利用者からフィードバックを収集
- 開発者、デザイナー、QAなど異なる役割からの視点を取り入れる
- フィードバックに基づいて改善を行う

#### 品質メトリクス

- 仕様書の完成度を測定する指標を設定
- 必須項目のカバレッジ率
- レビュー指摘事項の数と解決率
- 仕様書の更新頻度

## README・インデックス管理

### ルートディレクトリのREADME.md管理

#### 配置ルール

- ルートディレクトリ（screen-specs/）にREADME.mdを必須で配置
- フラット構造のため、アプリ・機能別のディレクトリは存在しない
- 機能単位のまとめはインデックスファイル（`.spec.index.md`）で行う

#### README.md記載内容

```markdown
# 画面仕様書

## 概要

アプリケーションの全画面仕様を管理しています。

## アプリ別構成

- admin: 管理者向け画面
- customer: 顧客向け画面
- operation: 実務者向け画面
- shared: 共通コンポーネント・仕様

## 共通ルール

- [画面仕様書作成ルール](mdc:.cursor/rules/screen-specs-overview.mdc)を参照
- [テンプレート](mdc:docs/screen-specs/TEMPLATE.md)を参照
- [用語集](mdc:docs/screen-specs/ubiquitous.md)を参照

## 機能別インデックス

| アプリ   | 機能                 | インデックスファイル                                    |
| -------- | -------------------- | ----------------------------------------------- |
| 管理者   | 顧客管理             | ./admin_customer-detail_管理者_顧客詳細機能.spec.index.md |
| 顧客     | マイページ           | ./customer_mypage_顧客_マイページ.spec.index.md |
| 実務者   | 診療機能             | ./operation_examinations_実務者_診療機能.spec.index.md |

## コンポーネント一覧

| アプリ         | コンポーネント名       | 仕様書リンク                                        |
| -------------- | ---------------------- | --------------------------------------------------- |
| 全アプリ       | チェックボックス       | ./shared_components_checkbox_共通コンポーネント_チェックボックス.spec.md |
| 顧客           | ヘッダー               | ./customer_components_header_顧客_共通コンポーネント_ヘッダー.spec.md |
```

#### README.mdの更新ルール

- 新しいインデックスファイル（`.spec.index.md`）を作成した場合は、README.mdの機能別インデックスを更新
- 新しい共通コンポーネントを作成した場合は、コンポーネント一覧を更新
- ファイル名や機能名が変更された場合は、関連するリンクを更新

### インデックスファイル（`.spec.index.md`）の管理

#### 作成ルール

- 機能単位でインデックスファイルを作成
- 同じ機能に関連する複数の仕様書がある場合に作成
- ファイル名パターン： `{アプリ}_{機能}_{日本語名}.spec.index.md`

#### 記載内容

```markdown
# 機能名

## 概要

機能の概要説明

## 画面遷移図

(マーメイド図を作成)

## 関連仕様書

| 画面・要素名 | 仕様書リンク |
| -------------- | -------------- |
| メインページ   | ./ファイル名.spec.md |

## 共通仕様

- 関連する共通仕様へのリンク
```

### メンテナンスルール

#### ファイル管理

**新しい機能の仕様書を追加した場合：**
1. 該当機能のインデックスファイルを作成または更新
2. README.mdの機能別インデックスを更新

**新しい共通コンポーネントを追加した場合：**
1. README.mdのコンポーネント一覧を更新

#### 管理のポイント

- フラット構造のため、ファイル名での検索性を重視
- インデックスファイルで機能単位のまとめを提供
- README.mdで全体の構造とナビゲーションを提供

## 開発環境URL・リンク管理

### 開発環境URL

開発環境の確認時に使用できるURLは以下の形式で定義します：

#### DevのURL

numberには、DEV番号の数字が入る。DEVだけの場合は数字なし。

- **実務者CRM（Operator）**
  - `https://operation.dev{number}.crm2.internetclinic-app.com/examinations`
- **管理者CRM（Admin）**
  - `https://admin.dev{number}.crm2.internetclinic-app.com/customers`
- **顧客側UI_ヘアリティ（Customer）**
  - `https://hairlity.customer.dev{number}.crm2.internetclinic-app.com`
- **顧客側UI_スマクリ（Customer）**
  - `https://sumakuri.customer.dev{number}.crm2.internetclinic-app.com`
- **StoryBook(Operator, Admin)**
  - `https://storybook-crm-712714814061.asia-northeast1.run.app/`
- **StoryBook(Customer)**
  - `https://storybook-customer-712714814061.asia-northeast1.run.app/`

### 参照リンクの更新ルール

- ファイル名やパスが変更された場合は、そのファイルを参照している全てのファイルを更新する
- ディレクトリ構造が変更された場合は、関連する全ての参照を更新する
- 参照の整合性は定期的にチェックする

### リンク管理のベストプラクティス

- 相対パスを使用する: `./ファイル名.spec.md`
- 絶対パスは使用しない
- MDC形式での参照: `[表示テキスト](mdc:docs/screen-specs/ファイル名.spec.md)`
- セクション参照: `./ファイル名.spec.md#section`

## よくある質問

**Q: 品質チェックはいつ行う？**
A: 新規作成時、更新時、定期レビュー時に実施

**Q: README.mdの更新頻度は？**
A: 新しいファイル追加時、機能追加時に即座に更新

**Q: リンク切れをチェックする方法は？**
A: 定期的に全ファイルの参照リンクを確認し、動作検証を実施

**Q: インデックスファイルはいつ作る？**
A: 同じ機能で複数の仕様書が存在する場合に作成