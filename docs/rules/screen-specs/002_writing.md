# 画面仕様書の記述・更新

既存の画面仕様書を編集・更新する際の完全ガイドです。このファイルだけを参照すれば、記述・更新作業を完了できます。

## 基本ルール

- 画面仕様書は [TEMPLATE.md](mdc:docs/screen-specs/TEMPLATE.md) のフォーマットを厳密に遵守し、必要に応じて要素を追加
- 全ての必須セクションを漏れなく記載する
- 記述は簡潔かつ明確に行う
- **スタイルについての記述は含めない**（CSSやデザインシステムに委ねる）
- **RPCメソッドについてはリクエスト・レスポンスは載せず、フォーマットの項目のみに留める**
- **記述する内容がない場合、`----` でブランク表示すること**
- **ソースコード上で確認できる仕様のみ記述する**

## 表形式での記述

### 基本方針

- TEMPLATE.mdで定義された表フォーマットを厳密に遵守する
- **記載する内容が存在しない場合でも表自体は作成し、`----` でブランク表示を行う**
- 追加の情報が必要な場合は、補足的な表や説明を別セクションとして追加する
- 提供された情報に不足がある場合は、ユーザに質問する

### 補足情報の追加方法

**1. 補足表の追加**

```markdown
### 入力項目一覧

[TEMPLATE.mdで定義された標準フォーマットの表]

### 入力項目補足情報

| 項目名 | 補足説明 | 関連ルール |
| ------ | -------- | ---------- |
```

**2. 補足セクションの追加**

```markdown
### バリデーション一覧

[TEMPLATE.mdで定義された標準フォーマットの表]

### バリデーション補足ルール

- 特殊なバリデーションルールの説明
- 条件分岐の詳細
```

### 具体例

```markdown
### 入力項目一覧

| 項目名 | 必須 | 種別 | デフォルト | 文字種 | 文字数 | 説明           |
| ------ | ---- | ---- | ---------- | ------ | ------ | -------------- |
| 氏名   | 必須 | text | 実装上の値を使用 | 全角   | 50     | ユーザーの氏名 |

### 入力項目補足情報

| 項目名 | 入力形式                      | エラー時の挙動               |
| ------ | ----------------------------- | ---------------------------- |
| 氏名   | 姓と名の間にスペースを1つ入力 | スペースの数をチェックし警告 |
```

## 用語の統一

### 基本原則

- 同じ概念には同じ用語を使用する
- システム固有の用語は一貫して使用する
- 略語を使用する場合は初出時に正式名称を記載する

### 権限用語の統一（必須）

権限に関する用語は、用語集で定義された権限一覧に**厳密に**準拠すること：

- **operation アプリ**: 医師、看護師、カウンセラー、発送オペレーター、全て
- **admin アプリ**: 管理者
- **customer アプリ**: ログイン（認証）済み顧客、未ログイン（認証）顧客

**重要**: 略称や省略形は使用せず、必ず上記の正式名称を使用する（例：「顧客」ではなく「ログイン（認証）済み顧客」）

### 表記ルール

- 日本語と英語の混在は避ける
- 英語の場合は、大文字小文字の使い分けを一貫させる
- 数字の表記（半角/全角）を統一する
- **日付表示の形式**: コード内で使用しているformat関数の引数を確認して反映する

### 用語集の活用

- 用語の定義はプロジェクト用語集を参照する
- 新しい用語を導入する場合は、用語集に追加する

## 画面要素の記述

### 基本ルール

- 画面要素は全て入力項目または出力項目のどちらかに必ず記述する
- ユーザーによる入力が可能な要素（ボタン、フォームなど）は入力要素として記述する
- インタラクション不能な要素は出力要素として記述する
- 補足的な内容は専用のテーブルをセクション内に作って記述する
- 画面要素は基本的にネストさせない
- ネストが必要な場合は、タイトルを「親セクション名 - 子セクション名」の形式で記述

### 入力項目の記述

入力項目はユーザーがUI上でインタラクション可能な要素について、以下のフォーマットで記述する：

```markdown
**入力項目一覧**

| 項目名   | 必須        | 種別   | デフォルト     | 文字種   | 文字数   | 説明   |
| -------- | ----------- | ------ | -------------- | -------- | -------- | ------ |
| 氏名 | 必須 | text | 実装上の値を使用 | 全角 | 50 | ユーザーの氏名 |

**備考**

| 項目   | 内容   |
| ------ | ------ |
| 氏名 | 姓と名の間にスペースを1つ入力 |
```

### 出力項目の記述

出力項目はユーザーがインタラクション不可の要素について、以下のフォーマットで記述する：

```markdown
**出力項目一覧**

| 項目名   | 説明   |
| -------- | ------ |
| ユーザー情報 | ログインユーザーの情報を表示 |

**備考**

| 項目   | 内容   |
| ------ | ------ |
| ユーザー情報 | 未ログイン時は「ゲスト」と表示 |
```

### バリデーション一覧の記述

フロントエンドの実装上で確認できるフォームバリデーション（React Hook Formなど）について以下のフォーマットで記述する：

```markdown
| エラー概要   | エラーメッセージ   | エラー原因   |
| ------------ | ------------------ | ------------ |
| [エラー概要] | [エラーメッセージ] | [エラー原因] |
```

### エラー／例外ケースの記述

APIリクエスト実行時関連のエラー処理について以下のフォーマットで記述する：

```markdown
| エラー概要   | エラーメッセージ   | エラー原因   |
| ------------ | ------------------ | ------------ |
| [エラー概要] | [エラーメッセージ] | [エラー原因] |
```

## 文言の記述

- 短い文言（ラベル、ボタン名など）は全て仕様書に記載
- 長文（説明文、ヘルプテキストなど）は概要レベルの説明に留める

例：

```markdown
### ヘルプテキスト

| 項目     | 概要                   | 文言参照                                       |
| -------- | ---------------------- | ---------------------------------------------- |
| 利用規約 | サービスの利用規約説明 | @利用規約文言   |
| 注意事項 | 処方箋購入時の注意点   | @注意事項文言 |
```

### 文言の変更管理

- 文言の変更履歴を記録する
- 重要な文言の変更は承認プロセスを経る
- 文言変更の影響範囲を明確にする

## 参照の記述

### 関連仕様の参照

- 画面を跨ぐ共通仕様は別ファイルにまとめる
- 共通仕様は命名規則によって識別する：
  - `customer_components_`: 顧客アプリ専用コンポーネント
  - `shared_components_`: 全アプリ共通コンポーネント
  - `shared_`: 共通仕様（エラーメッセージ、バリデーションなど）

### 参照形式

- **同一階層での参照**: `./ファイル名.spec.md`
- **MDC形式での参照**: `[表示テキスト](mdc:docs/screen-specs/ファイル名.spec.md)`
- **セクション参照**: `./ファイル名.spec.md#section`
- **共通コンポーネント**: `@コンポーネント名`
- **共通仕様**: `@仕様名`

### ファイル参照の例

- 同じ機能の別ファイル参照：`./admin_customer-detail__affected-area-image-tab_管理者_顧客詳細__患部画像タブ.spec.md`
- 共通コンポーネント参照：`./shared_components_checkbox_共通コンポーネント_チェックボックス.spec.md`

## よくある質問

**Q: 内容がない項目はどう記述する？**
A: 表自体は作成し、内容部分に `----` でブランク表示

**Q: 権限名はどう書く？**
A: 略称は使わず、必ず正式名称を使用（例：「ログイン（認証）済み顧客」）

**Q: 補足情報が多い場合は？**
A: 標準表の後に補足表や補足セクションを追加

**Q: 他の仕様書を参照したい場合は？**
A: `./ファイル名.spec.md` 形式で相対パス参照を使用